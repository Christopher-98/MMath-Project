---
title: "Project"
author: "Chris Martin"
date: "08/12/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Abstract

## Introduction

The purpose of this report is to detail to extensions made to the dsims R package and conduct analysis to compare the abundance estimates generated through a design based approach, distance sampling, and a model based approach, density surface modelling. This will allow researchers the opportunity to use the best possible model to fit the circumstances of their own study. 

## Background research

Distance sampling is an approach to estimating population abundance and density by surveying a small portion

need to define truncation distance, detection function, abundance and density from literature.

explanation of how the ds and dsm models generate their abundance estimates in R and under what circumstances one may be better than the other to inform potential comparisons

## Distance Sampling Simulations

All the material in this section is based on Buckland et al (2015) Prior to the simulation for a particular design being run, a number of objects must be first be defined. The first object is the study region, this can either be the default generated by R or user defined from a shapefile. Following this, a spatial distribution or density surface must be defined, from which animal locations can be generated based on the population description. The desired population size can be user defined and set for a series of simulations or be generated based on the spatial distribution supplied by the user. The desired truncation distance must then be defined and based on this an appropriate design can be generated. The main considerations when constructing the design are the type, either line or point transects and the desired number or length of transects. If line transects are used, the design angle may be altered from its default of 0. Based on the design, a set of survey transects can be generated, during which the detection process is simulated. The user can then define a detection function, based on either a half normal ('hn'), hazard rate ('hr') or uniform distribution ('uf') with a defined scale parameter and the desired truncation distance _w_. Therefore for an animal at distance _x_ from the closest transect the probability of the animal being detected is given by the detection function eveluated at _x_, provided _x_ \le _w_. 

## Modelling

the simulation was initially tested using the default region generated by dsims with a point transect design aiming for 25 points with a truncation distance of 60. A test density was then constructed for the region with high and low spots as seen below with relatively gently gradients.

```{r}


#plot(density, region) 

```

A population description was then constructed based on this density surface with a population of 1000 to start. A detection function was then defined as a half normal with scale parameter of 30. This produces the following detection function:
```{r} plot(detect, pop.des) ```

A prediction grid is then constructed across the study region and is the same for each run of the simulation.

The simulation loop then begins. For each iteration, a new survey constructed. From this, the observation data and segmented data is extracted. Based on this data, both a distance sampling model and density surface model are constructed, with the degrees of freedom in the dsm model being restricted to the number of point transects and its family being tweedie. the abundance estimates are extracted from both models and stored. 

## results

Having completed 2000 bootstrap simulations for both the distance sampling and density surface models, we can now examine and compare these to give us an insight into the circumstances under which a particular model is better of worse than the other. For the initial default region, the histograms of both the distance sampling and dsm abundance estimates are displayed below:
```{r}
default.dsm <- read.csv('dsm.estimates.region.csv')
default.ds <- read.csv('ds.estimates.region.csv')

hist(default.dsm$x, main = 'Histogram of DSM estimates')
hist(default.ds$x, main = 'Histogram of DS estimates')

```

These plots show somewhat similar data as we would expect since both estimates are generated by the same data set. If we now compare the means and 95% confidence intervals:
```{r}
mean(default.dsm$x)
mean(default.ds$x)

quantile(default.dsm$x, c(0.025, 0.975))
quantile(default.ds$x,c(0.025, 0.975))
```

It can be seen that the dsm method appears to xxx the true population while the distance sampling method does xxx. Examining the confidence intervals for both methods, the interval for the dsm model is in this case wider than that of the ds model, indicating it is slightly less accurate in the case of this region and density surface. 


## conclusion
